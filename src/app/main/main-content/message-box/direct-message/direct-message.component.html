<div class="df_fd_c message-box">
  <div class="header">
    <div class="df_fd_r_aic main-content">
      <img *ngIf="selectedUser?.picture" class="user-avatar" src="{{ selectedUser?.picture }}" alt="Avatar">
      <div class="user-name">{{ selectedUser?.name }}</div>
    </div>
  </div>

  <div class="df_fd_jce content">
    <div class="df_fd_c_ais_jcsb first-content pad-b-24">
      <div class="df_fd_r picture-name-container">
        <img *ngIf="selectedUser?.pictureSvg" class="big-icon" src="{{ selectedUser?.picture }}">
      </div>
      <div *ngIf="isSelfChat">
        <div class="pad-b-24">
          <img class="avatar-chat-img" src="{{ selectedUser?.picture }}" alt="">
          <span class="user-big-name">{{ selectedUser?.name }} (Du)</span>
        </div>
        <span>Dieser Raum ist nur für dich da.</span> Mache dir Notizen, liste deine To-dos auf oder bewahre Links und
        Dateien griffbereit auf.
      </div>
      <div *ngIf="!isSelfChat">
        <div>
          <img class="avatar-img" src="{{ selectedUser?.picture }}" alt="">
          <span class="user-big-name">{{ selectedUser?.name }}</span>
        </div>
        Diese Unterhaltung findet zwischen <a href="#"> {{ '@' + selectedUser?.name }}</a> und dir statt.
      </div>
    </div>
  </div>

  <div class="messages">
    @for (timeObj of directMessagesTime; track timeObj; let index = $index) {
    <!-- Datumskopf nur einmal pro Tag -->
    @if (shouldShowDate(timeObj.timestamp, index)) {
    <div class="date-container df_jcc_aic">
      <span>{{ timeObj.timestamp | date:'d. MMMM':'' }}</span>
    </div>
    }

    <!-- Die zugehörige Nachricht -->
    <div *ngIf="directMessages[index] as msg" class="message df_fd_r_aic">
      <img class="avatar-chat-img" [src]="msg.senderId?.picture" alt="">
      <div>
        <div class="sendername-time-container df_fd_r_aic_jcsb">
          <span><b>{{ msg.senderId?.name }}</b></span>
          <span class="time">
            {{ timeObj.timestamp | date:'HH:mm':'' }}
          </span>
        </div>
        <div class="sender-message-box" [ngClass]="{'own-message': msg.senderId === currentUser?.id}">
          {{ msg.text }}
        </div>
      </div>
    </div>
    }
  </div>

  <app-textarea [textInput]="textInput" [mainMessageBoxPadding]="'2.5rem 2.8125rem 2.5rem 2.8125rem'"
    [toolbarWidth]="'calc(100% - 8.125rem)'" placeholder="Nachricht an {{ selectedUser?.name }}">
  </app-textarea>
</div>